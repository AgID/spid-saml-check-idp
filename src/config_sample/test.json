{
    "metadata": {
        "description": "Suite Test Metadata",
        "cases": {
            "test-case-metadata-0": {
                "name": "Test Case Metadata base",
                "description": "Test Case Metadata base.",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "metadata": [
                        "1.0.0", "1.2.0", "1.2.1", "1.2.2", "1.2.3", "1.2.4", "1.2.5", "1.2.6",
                        "1.3.4", "1.3.5", "1.3.6", "1.3.7", "1.3.8", "1.3.11", "1.7.0", "1.10.0", "1.11.0"
                    ] 
                }
            }
        }
    },
    "saml-core": {
        "description": "Suite Test Core",
        "cases": {
            "test-case-saml-core-0": {
                "name": "0 - SAML Core base (SPID Level 1, Binding: HTTP-Redirect)",
                "description": "Executes the SAML AuthnRequest for SPID Level 1. Binding: HTTP-Redirect",
                "image": "test-case-saml-core",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [
                        "2.0.0"
                    ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1"
                    ]
                }
            },
            "test-case-saml-core-1": {
                "name": "1 - SAML Core base (SPID Level 1, Binding: HTTP-POST)",
                "description": "Executes the SAML AuthnRequest for SPID Level 1. Binding: HTTP-POST",
                "image": "test-case-saml-core",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [
                        "2.0.1"
                    ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1"
                    ]
                }
            },
            "test-case-saml-core-2": {
                "name": "2 - SAML Core base (SPID Level 2, Binding: HTTP-Redirect)",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-Redirect",
                "image": "test-case-saml-core",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [
                        "2.0.2"
                    ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1"
                    ]
                }
            },
            "test-case-saml-core-3": {
                "name": "3 - SAML Core base (SPID Level 2, Binding: HTTP-POST)",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST",
                "image": "test-case-saml-core",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [
                        "2.0.3"
                    ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1"
                    ]
                }
            },
            "test-case-saml-core-4": {
                "name": "4 - AssertionConsumerServiceIndex is present and is not a number",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AssertionConsumerServiceIndex: index",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.4.1" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-5": {
                "name": "5 - AssertionConsumerServiceIndex is present and is not a valid index",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AssertionConsumerServiceIndex: 123456789",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.4.2" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-6": {
                "name": "6 - AssertionConsumerService(Index and URL) are both present",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AssertionConsumerServiceIndex: 1. AssertionConsumerServiceURL: /acs",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.4.3" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-7": {
                "name": "7 - AssertionConsumerService(Index and URL) are both not present",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AssertionConsumerServiceIndex and AssertionConsumerServiceURL both not present",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.4.4" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-8": {
                "name": "8 - AssertionConsumerServiceURL is present and is not a URL",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AssertionConsumerServiceURL: imnoturl",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.4.5" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-9": {
                "name": "9 - AssertionConsumerServiceURL is present and is not a valid URL (as from SP Metadata)",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AssertionConsumerServiceURL: /samlacsisnotvalid",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.4.6" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-10": {
                "name": "10 - The AttributeConsumingServiceIndex attribute does not have a value",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AttributeConsumingServiceIndex: ''",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.6.1" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-11": {
                "name": "11 - The value of AttributeConsumingServiceIndex attribute is < 0",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AttributeConsumingServiceIndex: '-2'",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.6.2" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-12": {
                "name": "12 - The value of AttributeConsumingServiceIndex is not valid (as from SP Metadata)",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AttributeConsumingServiceIndex: '123456789'",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.6.3" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-13": {
                "name": "13 - The Issuer element does not have a value",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Issuer: ''",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.8.2" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-14": {
                "name": "14 - The value of Issuer is different from EntityID of SP metadata",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Issuer: '<EntityID>-different'",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.8.3" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-15": {
                "name": "15 - The Comparison attribute is not present",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Comparison not present",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.10.2" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-16": {
                "name": "16 - The Comparison attribute does not have a value",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Comparison: ''",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.10.3" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-17": {
                "name": "17 - The value of Comparison attribute is different from “minimum” (WARN)",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Comparison: 'exact'",
                "image": "test-case-saml-core",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.10.4" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-18": {
                "name": "18 - More than one AuthnContextClassRef element are present",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AuthnContextClassRef: ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.10.5" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-19": {
                "name": "19 - The AuthnContexClassRef element does not have a value",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AuthnContextClassRef: ''",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.10.6" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-20": {
                "name": "20 - The value of AuthnContextClassRef element is not a valid SPID level",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. AuthnContextClassRef: 'https://www.spid.gov.it/SpidL0'",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.10.7" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-21": {
                "name": "21 - The Signature element is not present",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Signature not present",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.13.1" ],
                    "authentication-response": []
                }
            },
            "test-case-saml-core-22": {
                "name": "22 - The AuthnRequest does not have a valid signature",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. Signature not valid",
                "image": "test-case-request-error",
                "ref": "SPID-QAD-SAML-IDP",
                "hook": {
                    "authentication-request": [ "2.14.1" ],
                    "authentication-response": []
                }
            },
            "test-case-aa-1": {
                "name": "AA1 - Attribute Authority - AuthnRequest contains the extension RequiredAttributeAuthority but it’s not in the correct place inside AuthnRequest",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. The request is not valid for Attribute Authority selection. IdP MUST follow with Authentication without AA selection",
                "image": "test-case-aa-skip-selection",
                "ref": "SPID-QAD-SAML-IDP-AttributeAuthority-Request",
                "hook": {
                    "authentication-request": [ "2.19.0" ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1", "3.23.1"
                    ]
                }
            },
            "test-case-aa-2": {
                "name": "AA2 - Attribute Authority - The RequiredAttributeAuthority does not contain any Location elements",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. The request is not valid for Attribute Authority selection. IdP MUST follow with Authentication without AA selection",
                "image": "test-case-aa-skip-selection",
                "ref": "SPID-QAD-SAML-IDP-AttributeAuthority-Request",
                "hook": {
                    "authentication-request": [ "2.19.1" ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1", "3.23.1"
                    ]
                }
            },
            "test-case-aa-3": {
                "name": "AA3 - Attribute Authority - The value of all Location elements inside RequiredAttributeAuthority element are empty",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. The request is not valid for Attribute Authority selection. IdP MUST follow with Authentication without AA selection",
                "image": "test-case-aa-skip-selection",
                "ref": "SPID-QAD-SAML-IDP-AttributeAuthority-Request",
                "hook": {
                    "authentication-request": [ "2.19.2" ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1", "3.23.1"
                    ]
                }
            },
            "test-case-aa-4": {
                "name": "AA4 - Attribute Authority - The RequiredAttributeAuthority element is well formed but none of the values of Location elements inside RequiredAttributeAuthority element are present in the SPID OIDC Registry at the entity listing endpoint",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. The request is not valid for Attribute Authority selection. IdP MUST follow with Authentication without AA selection",
                "image": "test-case-aa-search-skip-selection",
                "ref": "SPID-QAD-SAML-IDP-AttributeAuthority-Request",
                "hook": {
                    "authentication-request": [ "2.19.3" ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1", "3.23.1"
                    ]
                }
            },
            "test-case-aa-5": {
                "name": "AA5 - Attribute Authority - The RequiredAttributeAuthority element is well formed and at least one value of Location elements inside RequiredAttributeAuthority is not empty and is present in the SPID OIDC Registry at the entity listing endpoint. User does not select any AA.",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. The request is valid for Attribute Authority selection. IdP MUST follow with Authentication and AA selection. User does not select any AA, so IdP MUST present consent form but directly redirect to SP with the Response",
                "image": "test-case-aa-selection-none",
                "ref": "SPID-QAD-SAML-IDP-AttributeAuthority-Request",
                "hook": {
                    "authentication-request": [ "2.19.5", "2.20.1", "2.20.2", "2.20.3", "2.20.4", "2.20.5" ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1", "3.23.1"
                    ]
                }
            },
            "test-case-aa-6": {
                "name": "AA6 - Attribute Authority - The RequiredAttributeAuthority element is well formed and at least one value of Location elements inside RequiredAttributeAuthority is not empty and is present in the SPID OIDC Registry at the entity listing endpoint. User select at least one AA.",
                "description": "Executes the SAML AuthnRequest for SPID Level 2. Binding: HTTP-POST. The request is valid for Attribute Authority selection. IdP MUST follow with Authentication, AA selection and GrantToken generation. Finally IdP MUST redirect to SP with a Response containing GrantToken for every selected AA",
                "image": "test-case-aa-selection",
                "ref": "SPID-QAD-SAML-IDP-AttributeAuthority-Request",
                "hook": {
                    "authentication-request": [ "2.19.6", "2.20.1", "2.20.2", "2.20.3", "2.20.4", "2.20.5" ],
                    "authentication-response": [
                        "3.1.7", "3.1.8", "3.1.9", "3.1.10", "3.3.1", "3.9.4", "3.9.5", "3.10.1", 
                        "3.14.1", "3.14.2", "3.16.1", "3.16.2", "3.16.3", "3.16.5", "3.17.1",
                        "3.18.1", "3.18.2", "3.18.3", "3.18.5", "3.19.1", "3.19.2", "3.19.3", "3.19.4",
                        "3.20.1", "3.20.2", "3.20.3", "3.20.4",
                        "3.21.0", "3.21.1", "3.21.2", "3.21.3", "3.21.4", "3.21.5", "3.21.7",
                        "3.22.0", "3.22.1", "3.22.2", "3.22.3", "3.22.4", "3.22.5", "3.22.6", "3.22.7", "3.22.8", 
                        "3.22.9", "3.22.10", "3.22.11", "3.22.12", "3.22.13", "3.22.14", "3.22.15", 
                        "3.22.16", "3.22.17", "3.22.18", "3.22.19", "3.22.20", "3.22.21", "3.22.22", "3.22.23", "3.22.24", "3.22.25", "3.22.26"

                    ]
                }
            }
            
        }
    }
}